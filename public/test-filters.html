<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Filtros</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        select, button { padding: 10px; margin: 10px; font-size: 16px; }
        #results { margin-top: 20px; padding: 20px; background: #f5f5f5; }
        .transaction { margin: 10px 0; padding: 10px; background: white; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Test de Filtros de Métodos de Pago</h1>
    
    <div>
        <label>Método de Pago:</label>
        <select id="payment-method">
            <option value="">Todos los Métodos</option>
            <option value="pago_tarjeta">Pago con Tarjeta</option>
            <option value="pago_efectivo">Pago en Efectivo</option>
            <option value="otros_metodos">Otros Métodos</option>
        </select>
        <button onclick="testFilter()">Probar Filtro</button>
    </div>
    
    <div id="results">
        <p>Probando filtro de Pago en Efectivo automáticamente...</p>
    </div>

    <script>
        // Auto-test efectivo al cargar la página
        window.onload = function() {
            document.getElementById('payment-method').value = 'pago_efectivo';
            testFilter();
        };

        async function testFilter() {
            const paymentMethod = document.getElementById('payment-method').value;
            const resultsDiv = document.getElementById('results');
            
            resultsDiv.innerHTML = '<p>Cargando...</p>';
            
            try {
                const url = paymentMethod ? 
                    `/api/transactions/today?paymentMethod=${paymentMethod}` : 
                    '/api/transactions/today';
                    
                const response = await fetch(url);
                const transactions = await response.json();
                
                if (transactions.length === 0) {
                    resultsDiv.innerHTML = '<p>No se encontraron transacciones con este filtro.</p>';
                    return;
                }
                
                let html = `<h3>Encontradas ${transactions.length} transacciones:</h3>`;
                transactions.slice(0, 5).forEach(t => {
                    html += `
                        <div class="transaction">
                            <strong>Cliente ${t['Cliente ID']}</strong> - 
                            <strong>Cajero ${t['Cajero ID']}</strong> - 
                            <strong>Método: ${t['Payment Method']}</strong> - 
                            <strong>Tipo: ${t.Type}</strong>
                        </div>
                    `;
                });
                
                if (transactions.length > 5) {
                    html += `<p>... y ${transactions.length - 5} más</p>`;
                }
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                resultsDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
